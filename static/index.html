<!DOCTYPE html>
<html>
<head>
    <title>Учет производства | Сибирь</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #4285f4;
            --accent-color: #e74c3c;
            --light-bg: #f5f7fa;
        }
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(rgba(245, 247, 250, 0.9), rgba(245, 247, 250, 0.9)), 
                        url('https://images.unsplash.com/photo-1609879071226-55dbf8f30ff4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .form-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            font-size: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--primary-color);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
            outline: none;
        }
        
        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 15px;
        }
        
        button {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 14px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        button:hover {
            background: #3367d6;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .status-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        .status-content {
            max-width: 80%;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            font-size: 18px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
        }
        
        .status-success {
            background: #e6f7ee;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
        }
        
        .status-error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef9a9a;
        }
        
        .custom-input {
            margin-top: 10px;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .logo {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .logo img {
            height: 60px;
        }

        /* Мобильная адаптация */
        @media (max-width: 768px) {
            body {
                background-attachment: scroll;
            }
            
            .form-container {
                margin: 20px 15px;
                padding: 20px;
                border-radius: 6px;
            }
            
            h1 {
                font-size: 20px;
                margin-bottom: 20px;
            }
            
            input, textarea, select {
                padding: 10px 12px;
                font-size: 15px;
            }
            
            button {
                padding: 12px 15px;
                font-size: 15px;
            }
            
            .logo img {
                height: 50px;
            }
            
            .status-content {
                max-width: 90%;
                padding: 20px;
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .form-container {
                margin: 15px 10px;
                padding: 15px;
            }
            
            h1 {
                font-size: 18px;
                margin-bottom: 15px;
            }
            
            .form-group {
                margin-bottom: 15px;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="form-container">
        <div class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="60">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
            </svg>
        </div>
        <h1>Учет производства</h1>
        <div id="app">
            <div class="form-group">
                <label>Дата:</label>
                <input type="date" v-model="form.date">
            </div>
            
            <div class="form-group">
                <label>ФИО сотрудника:</label>
                <select v-model="form.fullName" required>
                    <option value="" disabled selected>Выберите сотрудника</option>
                    <option v-for="employee in employees" :value="employee">{{ employee }}</option>
                    <option value="Другой">Другой (указать)</option>
                </select>
                <input v-if="form.fullName === 'Другой'" 
                       v-model="customEmployee" 
                       placeholder="Введите ФИО" 
                       class="custom-input">
            </div>
            
            <div class="form-group">
                <label>Название детали и операции:</label>
                <select v-model="form.partAndOperation" required>
                    <option value="" disabled selected>Выберите операцию</option>
                    <option v-for="operation in operations" :value="operation">{{ operation }}</option>
                    <option value="Другая">Другая (указать)</option>
                </select>
                <input v-if="form.partAndOperation === 'Другая'" 
                       v-model="customOperation" 
                       placeholder="Введите название операции" 
                       class="custom-input">
            </div>
            
            <div class="form-group">
                <label>Количество деталей (общее):</label>
                <input type="number" v-model="form.totalParts" placeholder="10" min="0">
            </div>
            
            <div class="form-group">
                <label>Брак:</label>
                <input type="number" v-model="form.defective" placeholder="0" min="0">
            </div>
            
            <div class="form-group">
                <label>Примечания:</label>
                <textarea v-model="form.notes" rows="3" placeholder="Особенности работы..."></textarea>
            </div>
            
            <button @click="submit">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 8px;">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                    <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                Сохранить в таблицу
            </button>
            
            <div class="status-overlay" v-if="message" @click="message = ''">
                <div class="status-content" :class="{'status-success': !isError, 'status-error': isError}">
                    {{ message }}
                    <div style="margin-top: 20px; font-size: 14px; color: #666;">
                        Кликните, чтобы закрыть
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script>
        new Vue({
            el: '#app',
            data: {
                form: {
                    date: new Date().toISOString().substr(0, 10),
                    fullName: '',
                    partAndOperation: '',
                    totalParts: '',
                    defective: '',
                    notes: ''
                },
                employees: [
                    "Афанасьев",
                    "Бурлаков",
                    "Горемыкин",
                    "Маслов",
                    "Овсиенко",
                    "Серягин",
                    "Полушин",
                    "Отрадных",
                    "Соболев"
                ],
                operations: [
                    "Гайка Сибирь",
                    "Крышка Сибирь 1оп",
                    "Крышка Сибирь 2оп",
                    "Крышка Сибирь 3оп",
                    "Основание Сибирь 1-2оп",
                    "Сопло Сибирь",
                    "Трубка Сибирь",
                    "Втулка Сибирь (Алюм.)",
                    "Втулка Сибирь (Латунь)",
                    "Болт Зорька",
                    "Винт регулировочный М6",
                    "Винт регулировочный М8",
                    "Гайка МС",
                    "Крышка МС 1оп",
                    "Крышка МС 2оп",
                    "Крышка МС 3оп",
                    "Крышка МС 4оп",
                    "Основание МС 1оп",
                    "Основание МС 2оп",
                    "Основание МС 3-4оп",
                    "Сопло МС",
                    "Наконечник ДВИ",
                    "Закрутка Основание МС",
                    "Гайка МС доработка"
                ],
                customEmployee: '',
                customOperation: '',
                message: '',
                isError: false
            },
            methods: {
                async submit() {
                    if (this.form.fullName === 'Другой' && this.customEmployee) {
                        this.form.fullName = this.customEmployee;
                    }
                    
                    if (this.form.partAndOperation === 'Другая' && this.customOperation) {
                        this.form.partAndOperation = this.customOperation;
                    }

                    if (!this.form.fullName || !this.form.partAndOperation) {
                        this.showMessage("ФИО и название операции обязательны!", true);
                        return;
                    }

                    try {
                        const response = await fetch('/submit', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.form)
                        });
                        
                        if (!response.ok) {
                            const error = await response.text();
                            throw new Error(error);
                        }
                        
                        this.showMessage("Данные успешно сохранены в Google Таблицу!");
                        this.clearForm();
                    } catch (err) {
                        this.showMessage("Ошибка: " + err.message, true);
                    }
                },
                clearForm() {
                    this.form = {
                        date: new Date().toISOString().substr(0, 10),
                        fullName: '',
                        partAndOperation: '',
                        totalParts: '',
                        defective: '',
                        notes: ''
                    };
                    this.customEmployee = '';
                    this.customOperation = '';
                },
                showMessage(msg, isErr = false) {
                    this.message = msg;
                    this.isError = isErr;
                    setTimeout(() => this.message = '', 5000);
                }
            }
        });
    </script>
</body>
</html>